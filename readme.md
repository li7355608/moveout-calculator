# 退租费用计算器 (Moveout Calculator)

一个用于计算租户退租时水电燃气费用的Java应用程序，带有彩色控制台输出界面。

## 功能特点

- 计算水、电、燃气的使用量和费用
- 支持用户输入账单信息，更加灵活
- 自动生成详细的费用结算单
- 彩色控制台输出，提升用户体验
- 精确的BigDecimal计算，避免浮点数精度问题
- 支持充值金额计算和退款处理

## 系统架构

### 核心类说明

1. **MoveOutCalculatorService** - 核心计算服务类
    - 根据水电气单价和账单数据计算各项费用
    - 处理充值金额和退款计算

2. **BillingService** - 账单服务类
    - 管理整个费用计算流程
    - 处理用户输入账单数据
    - 显示计算结果（带彩色输出）

3. **工具类**
    - ConsoleColors - 控制台颜色工具类，提供各种颜色常量

4. **实体类**
    - Bill - 账单信息实体，包含入住和退租时的水电气读数及充值信息
    - CalculationResult - 计算结果实体，包含所有费用明细

## 使用方法

1. 运行 Main 类启动程序
2. 按照提示输入账单信息：
    - 入住日期和初始水电气余额
    - 充值金额
    - 退租日期和退租时水电气余额
3. 程序将自动计算并显示详细的费用结算单

## 费用计算逻辑

### 理论余额计算
```
理论余额 = 入住时余额 + 充值金额
```


### 实际消耗计算
```
实际消耗金额 = 理论余额 - 退租时余额
```


### 使用量计算
```
使用量 = |实际消耗金额| / 单价
```


### 费用计算
```
费用 = |实际消耗金额|
总费用 = 水费 + 电费 + 燃气费
```


### 退款计算
```
退款金额 = 总充值金额 - 总消费金额
```


- 退款金额为正：房东应退还给住户
- 退款金额为负：住户还需要补缴给房东

## 示例交互

程序运行后会提示用户输入账单信息：

```
=== 退租计算账单信息 ===
------------------------
住户入住信息：
请输入入住年份: 2025
请输入入住月份: 1
请输入入住日期: 20
请输入入住时水表金额(正数表示余额，负数表示欠费): 10
请输入入住时电表金额(正数表示余额，负数表示欠费): 50
请输入入住时燃气表金额(正数表示余额，负数表示欠费): 90

住户总充值信息：
请输入水费充值金额: 15
请输入电费充值金额: 30
请输入燃气费充值金额: 90

住户退租信息：
请输入退租年份: 2025
请输入退租月份: 6
请输入退租日期: 10
请输入退租时水表金额(正数表示余额，负数表示欠费): 14.39
请输入退租时电表金额(正数表示余额，负数表示欠费): 11.11
请输入退租时燃气表金额(正数表示余额，负数表示欠费): 143.60
------------------------
```


## 示例输出

程序将输出带有颜色的详细结算单：

```
=== 退租费用结算单 ===
入住时间: 2025年01月20日
退租时间: 2025年06月10日
居住天数: 141 天
------------------------
住户入住时状态：
  水费: 10 元 (余额)
  电费: 50 元 (余额)
  燃气费: 90 元 (余额)

住户充值金额：
  水费充值: 15 元
  电费充值: 30 元
  燃气费充值: 90 元
  充值总计: 135 元

住户退租时状态：
  水表: 14.39 元 (余额)
  电表: 11.11 元 (余额)
  燃气表: 143.60 元 (余额)

理论余额（入住时抄表余额 + 住户充值金额）：
  水费理论余额: 25 元 (余额)
  电费理论余额: 80 元 (余额)
  燃气费理论余额: 180 元 (余额)

住户实际消耗金额明细：
  水实际消耗: 10.61 元 (需要支付)
  电实际消耗: 68.89 元 (需要支付)
  燃气实际消耗: 36.40 元 (需要支付)

住户实际使用量明细：
  水使用量: 3.42 吨/立方米
  电使用量: 123.02 度
  燃气使用量: 12.38 立方米

费用明细：
  水费: 10.61 元
  电费: 68.89 元
  燃气费: 36.40 元
------------------------
总计应付费用: 115.90 元
住户充值金额: 135 元
房东应退款用户: 19.10 元
账单生成时间: 2025年09月02日 15:02:00
```
